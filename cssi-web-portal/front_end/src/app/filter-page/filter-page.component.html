<mat-toolbar color="primary" class="toolbar"
  >Filter Data<span class="push-links-right"></span
  ><a routerLink="/home" class="color-white">Go Home</a></mat-toolbar
>
<body class="background">
  <!-- <mat-card class="filter"> -->
  <p class="header-text">Select Data</p>
  <mat-accordion class="search-bar">
    <mat-card class="filter">
      <mat-expansion-panel
        class="search-expansion-box"
        (opened)="panelOpenState = true"
        (closed)="panelOpenState = false"
      >
        <!--This block indicates if the panel is open or not and adjusts the variable panelOpenState to the appropriate state-->
        <mat-expansion-panel-header>
          <mat-panel-title> Sort your data here! </mat-panel-title>
          <mat-panel-description>
            {{
              panelOpenState
                ? "Choose the parameters you'd like to view"
                : "Click me!"
            }}
          </mat-panel-description>
        </mat-expansion-panel-header>
        <img
          src="../../assets/placeholder_cat.jfif"
          alt="Grey cat sitting on couch"
        />
      </mat-expansion-panel>
    </mat-card>
  </mat-accordion>
  <!-- </mat-card> -->s

  <mat-card class="payload-table">
    <!-- Filters need to be reintroduced into the tables when I can reliably display data -->
    <!-- Filters need to be refined further -->

    <!-- Filter for Records -->
    <!-- <mat-form-field appearance="fill">
      <mat-label>Filter Records</mat-label>
      <input matInput [(ngModel)]="recordsFilter">
    </mat-form-field> -->

    <!-- Filter for Payload -->
    <mat-form-field appearance="fill">
      <mat-label>Filter payload</mat-label>
      <input matInput [(ngModel)]="payloadFilter">
    </mat-form-field>
    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyPayloadFilter($event)" placeholder="Dev_eui" #input>
    </mat-form-field>    

    <!--  Payload Table -->
    <p>Payload Table</p>
    <table mat-table [dataSource]="payloadDataSource" class="mat-elevation-z8">
      <!-- Dev_eui Column -->
      <ng-container matColumnDef="Dev_eui" class="dev_eui">
        <th mat-header-cell *matHeaderCellDef> dev_eui </th>
        <td mat-cell *matCellDef="let element"> {{element.dev_eui}} </td>
      </ng-container>

      <!-- Dev_time Column -->
      <ng-container matColumnDef="Dev_time" class="dev_time">
        <th mat-header-cell *matHeaderCellDef> dev_time </th>
        <td mat-cell *matCellDef="let element"> {{element.dev_time}} </td>
      </ng-container>

      <!-- Payload Columns / Dynamic -->
      <ng-container *ngFor="let column of payloadColumns" [matColumnDef]="column" class="dynamic_column">
        <th mat-header-cell *matHeaderCellDef> {{ column }} </th>
        <td mat-cell *matCellDef="let element"> {{ element.payload_dict[column] }} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['Dev_eui', 'Dev_time'].concat(payloadColumns)"></tr>
      <tr mat-row *matRowDef="let row; columns: ['Dev_eui', 'Dev_time'].concat(payloadColumns);"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
      </tr>
    </table>    

    <mat-paginator #payloadPaginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons aria-label="Select page of Payload Data"></mat-paginator>
    
  </mat-card>

  <mat-card class="metadata-table">
    <!-- Filter for Metadata -->
    <mat-form-field appearance="fill">
      <mat-label>Filter metadata</mat-label>
      <input matInput [(ngModel)]="metadataFilter">
    </mat-form-field>
    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyMetadataFilter($event)" placeholder="Dev_eui" #input>
    </mat-form-field> 
    
    <!--  Metadata Table -->
    <p>Metadata Table</p>
    <table mat-table [dataSource]="metadataSource" class="mat-elevation-z8">
      <!-- Dev_eui Column -->
      <ng-container matColumnDef="Dev_eui" class="dev_eui">
        <th mat-header-cell *matHeaderCellDef> dev_eui </th>
        <td mat-cell *matCellDef="let element"> {{element.dev_eui}} </td>
      </ng-container>

      <!-- Dev_time Column -->
      <ng-container matColumnDef="Dev_time" class="dev_time">
        <th mat-header-cell *matHeaderCellDef> dev_time </th>
        <td mat-cell *matCellDef="let element"> {{element.dev_time}} </td>
      </ng-container>

      <!-- Metadata Columns / Dynamic -->
      <ng-container *ngFor="let column of metadataColumns" [matColumnDef]="column" class="dynamic_column">
        <th mat-header-cell *matHeaderCellDef> {{ column }} </th>
        <td mat-cell *matCellDef="let element"> {{ element.metadata_dict[column] }} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['Dev_eui', 'Dev_time'].concat(metadataColumns)"></tr>
      <tr mat-row *matRowDef="let row; columns: ['Dev_eui', 'Dev_time'].concat(metadataColumns);"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
      </tr>
      
    </table>

    <mat-paginator #metadataPaginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons aria-label="Select page of Metadata Data"></mat-paginator>

  </mat-card>

  <app-temp-nav-bar></app-temp-nav-bar>
</body>
